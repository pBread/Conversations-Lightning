<aura:component controller="TwilioConversationApi">
  <!-- Parent Attributes -->
  <aura:attribute
    access="public"
    default=""
    description="The Id of the Twilio_Credentials__c record for this account"
    name="twilioAccount"
    required="true"
    type="Object"
  />
  <aura:attribute
    access="public"
    description="Contact record"
    name="contact"
    required="true"
    type="Object"
  />
  <aura:attribute
    access="public"
    description="Conversation record"
    name="conversation"
    required="true"
    type="Object"
  />

  <!-- Conversation Details -->
  <aura:attribute
    access="public"
    description="Message records"
    name="messages"
    type="Object[]"
  />
  <aura:attribute
    access="public"
    description="Participant records"
    name="participants"
    type="Object[]"
  />
  <aura:attribute
    access="public"
    description="Participant record of the Frontline/Flex user"
    name="agent"
    type="Object"
  />

  <!-- Events -->
  <aura:registerEvent name="updateIdentities" type="c:Update_Identities" />

  <!-- Handlers -->
  <aura:handler name="init" value="{!this}" action="{!c.initialize}" />

  <!-- UI -->
  <lightning:button label="Tester" onclick="{!c.tester}" />

  <section role="log" class="slds-chat">
    <div class="slds-chat-bookend">
      <p>
        Conversation with <b>{!v.agent.Name}</b> â€¢ {!v.conversation.lastUpdated}
      </p>
    </div>

    <ul class="slds-chat-list">
      <aura:iteration items="{!v.messages}" var="message">
        <c:Message
          agent="{!v.agent}"
          contact="{!v.contact}"
          message="{!message}"
        />
      </aura:iteration>
    </ul>
  </section>
</aura:component>
