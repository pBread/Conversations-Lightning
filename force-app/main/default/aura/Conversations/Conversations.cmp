<aura:component
  controller="TwilioConversationApi"
  implements="flexipage:availableForRecordHome, force:hasRecordId"
>
  <!-- Contact Record -->
  <aura:attribute name="contact" type="Object" />
  <aura:attribute name="recordError" type="String" />
  <force:recordData
    aura:id="recordLoader"
    fields="Name,MobilePhone"
    recordId="{!v.recordId}"
    recordUpdated="{!c.onRecordLoaded}"
    targetError="{!v.recordError}"
    targetFields="{!v.contact}"
  />
  <aura:if isTrue="{!not(empty(v.recordError))}">
    <div class="recordError">{!v.recordError}</div>
  </aura:if>

  <!-- Credentials -->
  <aura:attribute
    access="public"
    default="{}"
    description="Twilio Account records"
    name="twilioAccounts"
    type="Object[]"
  />

  <!-- UI -->
  <div class="c-header">
    <img height="50" width="50" src="{!$Resource.twilio_logo}" />
  </div>

  <aura:if isTrue="{!v.contact}">
    <aura:iteration items="{!v.twilioAccounts}" var="twilioAccount">
      <c:AccountContainer
        contact="{!v.contact}"
        twilioAccount="{!twilioAccount}"
      />
    </aura:iteration>
  </aura:if>
</aura:component>
